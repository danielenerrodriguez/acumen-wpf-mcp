name: Launch Acumen Fuse
description: Starts Acumen Fuse if not already running and waits for the main window to be ready
timeout: 120
parameters:
  - name: exePath
    description: Path to Fuse.exe
    required: false
    default: "C:\\Program Files\\Deltek\\Acumen 8.12\\Fuse.exe"

# Fuse startup phases (same PID, different window handles):
#   0-2s:  "Please wait while the application opens" (splash)
#   2-12s: "Deltek Acumen" (loading/initializing)
#   12s+:  "Workbook1 - Deltek Acumen" (ready)
steps:
  - action: launch
    exe_path: "{{exePath}}"
    if_not_running: true
    timeout: 60

  # Ready state title is always "<name> - Deltek Acumen" (with dash).
  # Loading phase is bare "Deltek Acumen" (no dash), so " - Deltek Acumen" 
  # distinguishes ready from loading AND works with any workbook name.
  - action: wait_for_window
    title_contains: " - Deltek Acumen"
    timeout: 90
    retry_interval: 2

  - action: wait
    seconds: 2
