name: Import XER and Run Analysis
description: Complete workflow - imports a P6 XER file and runs Fuse diagnostics analysis
timeout: 60
parameters:
  - name: filePath
    description: Full path to the XER file to import
    required: false
    default: 'C:\Program Files\Deltek\Acumen 8.12\Samples\Initial  Plan.xer'
  - name: exePath
    description: Path to Fuse.exe
    required: false
    default: 'C:\Program Files\Deltek\Acumen 8.12\Fuse.exe'

steps:
  # 1. Ensure Fuse is running
  - action: macro
    macro_name: acumen-fuse/launch
    params:
      exePath: '{{exePath}}'

  # 2. Open file dialog via keytips (S1 Projects > Oracle Primavera > All types)
  - action: focus
  - action: send_keys
    keys: Alt,S,O,A

  # 3. Navigate the file dialog to the XER file
  - action: file_dialog
    text: '{{filePath}}'
    timeout: 10

  # 4. Wait for file to load, then import all
  - action: wait
    seconds: 1
  - action: focus
  - action: send_keys
    keys: Alt,S,R,I

  # 5. Wait for import to complete (tabs become enabled), then switch to Diagnostics tab and run analysis
  - action: wait_for_enabled
    automation_id: uxRibbons
    timeout: 30
  - action: find
    automation_id: uxRibbons
    timeout: 5
    save_as: diagnosticsTab
  - action: click
    ref: diagnosticsTab
  - action: send_keys
    keys: F9

  # 6. Brief wait for analysis to complete
  - action: wait
    seconds: 2
