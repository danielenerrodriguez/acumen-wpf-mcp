name: Import XER and Run Analysis
description: Complete workflow - imports a P6 XER file and runs Fuse diagnostics analysis
timeout: 180
parameters:
  - name: filePath
    description: Full path to the XER file to import
    required: false
    default: 'C:\Program Files\Deltek\Acumen 8.12\Samples\Initial  Plan.xer'
  - name: exePath
    description: Path to Fuse.exe
    required: false
    default: 'C:\Program Files\Deltek\Acumen 8.12\Fuse.exe'

steps:
  # 1. Import the XER file
  - action: macro
    macro_name: acumen-fuse/import-xer
    params:
      filePath: '{{filePath}}'
      exePath: '{{exePath}}'

  # 2. Wait for import to finish
  - action: wait
    seconds: 5

  # 3. Run Fuse analysis
  - action: macro
    macro_name: acumen-fuse/run-fuse-analysis
    params:
      exePath: '{{exePath}}'
