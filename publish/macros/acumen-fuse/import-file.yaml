name: Import File
description: Launches Acumen Fuse (if needed) then opens the Import dialog and types a file path
timeout: 90
parameters:
  - name: filePath
    description: Full path to the file to import
    required: true
  - name: exePath
    description: Path to Fuse.exe (passed to launch macro)
    required: false
    default: "C:\\Program Files\\Deltek\\Acumen 8.12\\Fuse.exe"

steps:
  - action: macro
    macro_name: acumen-fuse/launch
    params:
      exePath: "{{exePath}}"

  - action: focus

  - action: send_keys
    keys: "Alt,F"

  - action: wait
    seconds: 0.5

  - action: find
    name: Import
    control_type: MenuItem
    save_as: importMenuItem
    timeout: 5

  - action: click
    ref: importMenuItem

  - action: wait
    seconds: 1

  - action: type
    text: "{{filePath}}"

  - action: send_keys
    keys: Enter
