name: Close Workbook
description: Closes the current workbook in Acumen Fuse without saving
timeout: 30
parameters:
  - name: exePath
    description: Path to Fuse.exe
    required: false
    default: 'C:\Program Files\Deltek\Acumen 8.12\Fuse.exe'

steps:
  # Inlined from acumen-fuse/launch
  - action: launch
    exe_path: '{{exePath}}'
    if_not_running: true
    timeout: 60
  - action: wait_for_window
    title_contains: ' - Deltek Acumen'
    timeout: 90
    retry_interval: 2

  - action: focus
  - action: send_keys
    keys: Alt,F,C

  # Wait for save prompt, then click "No" to discard changes
  - action: wait
    seconds: 1
  - action: find
    name: "No"
    control_type: Button
    save_as: noBtn
  - action: click
    ref: noBtn
