name: import-xer-logic-fs
description: Imports a P6 XER file into Acumen Fuse, switches to the S2 Logic tab, and selects the Finish to Start relationship type
timeout: 90
parameters:
  - name: filePath
    description: Full path to the XER file to import
    required: false
    default: 'C:\Program Files\Deltek\Acumen 8.12\Samples\Initial  Plan.xer'
  - name: exePath
    description: Path to Fuse.exe
    required: false
    default: 'C:\Program Files\Deltek\Acumen 8.12\Fuse.exe'

steps:
  # -- Inlined from acumen-fuse/launch --
  - action: launch
    exe_path: '{{exePath}}'
    if_not_running: true
    timeout: 60
  - action: wait_for_window
    title_contains: ' - Deltek Acumen'
    timeout: 90
    retry_interval: 2

  # -- Inlined from acumen-fuse/import-xer --
  - action: focus
  - action: send_keys
    keys: Alt,S,O,A
  - action: file_dialog
    text: '{{filePath}}'
    timeout: 15
  - action: wait
    seconds: 2
  - action: focus
  - action: send_keys
    keys: Alt,S,R,I
  # Verify import loaded data — tree root should show activity count > 0
  - action: find_by_path
    path:
      - 'SearchProp:AutomationId~PART_TreeView'
      - 'SearchProp:ControlType~TreeItem'
      - 'SearchProp:ControlType~Text'
    save_as: rootLabel
    timeout: 30
  - action: verify
    ref: rootLabel
    property: name
    match_mode: not_equals
    expected: "Workbook1 (0)"
    message: "Import verification failed — no activities were loaded"

  # -- Inlined from acumen-fuse/switch-to-tab (uxLogic) --
  - action: focus
  - action: find
    automation_id: uxLogic
    timeout: 5
    save_as: logicTab
  - action: click
    ref: logicTab

  # -- Select Finish to Start relationship type --
  - action: find
    name: Finish to Start
    control_type: RadioButton
    save_as: fsBtn
  - action: click
    ref: fsBtn
