name: Open Workbook
description: Opens an existing Acumen Fuse workbook (.afw) file
timeout: 60
parameters:
  - name: filePath
    description: Full path to the .afw workbook file
    required: true
  - name: exePath
    description: Path to Fuse.exe
    required: false
    default: 'C:\Program Files\Deltek\Acumen 8.12\Fuse.exe'

steps:
  - action: include
    macro_name: acumen-fuse/launch
    params:
      exePath: '{{exePath}}'

  - action: focus
  - action: send_keys
    keys: Alt,F,O

  # Navigate the file dialog to the workbook
  - action: file_dialog
    text: '{{filePath}}'
    timeout: 15

  # Wait for the workbook to load
  - action: wait_for_enabled
    automation_id: uxRibbons
    timeout: 30
